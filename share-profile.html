<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –¥—Ä—É–∑—å—è ‚Äî MeetUP</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="userSystem.js"></script>
    <style>
        :root {
            --bg-main: #000000;
            --gradient-yellow: #FFD700;
            --gradient-pink: #FF1493;
            --text-main: #FFFFFF;
            --text-muted: #AAAAAA;
            --button-gradient: linear-gradient(90deg, var(--gradient-yellow), var(--gradient-pink));
            --button-telegram: #0088CC;
            --button-whatsapp: #25D366;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-main);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        /* –ó–≤–µ–∑–¥—ã - —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ */
        .star {
            position: fixed;
            z-index: 0;
            animation: star-float 4s ease-in-out infinite;
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.5));
            opacity: 0.8;
            pointer-events: none;
        }

        @keyframes star-float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .share-container {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 24px;
            padding: 40px 30px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: container-appear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes container-appear {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* –ö—Ä–µ—Å—Ç–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è */
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            color: white;
            z-index: 10;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .close-btn .material-icons {
            font-size: 24px;
        }

        /* –õ–æ–≥–æ—Ç–∏–ø */
        .logo {
            font-size: 42px;
            font-weight: 900;
            background: var(--button-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            letter-spacing: 2px;
        }

        /* –ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .avatar-container {
            position: relative;
            width: 140px;
            height: 140px;
            margin: 0 auto 25px;
        }

        .avatar-frame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--button-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            animation: frame-pulse 2s infinite;
        }

        @keyframes frame-pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); }
            50% { box-shadow: 0 0 0 20px rgba(255, 215, 0, 0); }
        }

        .avatar-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #000;
        }

        .avatar-placeholder {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
            font-weight: bold;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-info {
            margin-bottom: 30px;
        }

        .username {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            background: var(--button-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-link {
            font-size: 16px;
            color: var(--text-muted);
            font-family: 'Courier New', monospace;
            margin-bottom: 25px;
            word-break: break-all;
            padding: 0 10px;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 35px;
            justify-content: center;
        }

        .btn-copy, .btn-qr {
            flex: 1;
            padding: 14px 20px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 140px;
        }

        .btn-copy {
            background: var(--button-gradient);
            color: black;
        }

        .btn-copy:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }

        .btn-qr {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-qr:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* –ü—Ä–∏–∑—ã–≤ */
        .call-to-action {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 35px;
            background: var(--button-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* –ö–Ω–æ–ø–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π */
        .social-share {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 25px;
        }

        .social-btn {
            flex: 1;
            padding: 16px 12px;
            border-radius: 12px;
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: white;
            min-width: 0;
            white-space: nowrap;
        }

        .social-btn .material-icons {
            font-size: 22px;
            flex-shrink: 0;
        }

        .btn-share-simple {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-basis: 100%;
        }

        .btn-share-simple:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .btn-telegram {
            background: var(--button-telegram);
            flex: 1;
        }

        .btn-telegram:hover {
            background: #0077b5;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 136, 204, 0.3);
        }

        .btn-whatsapp {
            background: var(--button-whatsapp);
            flex: 1;
        }

        .btn-whatsapp:hover {
            background: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.3);
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ QR –∫–æ–¥–∞ */
        .qr-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .qr-content {
            background: rgba(30, 30, 30, 0.95);
            border-radius: 24px;
            padding: 30px;
            max-width: 300px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.3s;
        }

        .qr-title {
            color: var(--gradient-yellow);
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: 600;
        }

        #qr-code {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 12px;
            display: inline-block;
        }

        .qr-actions {
            margin-top: 25px;
            display: flex;
            gap: 10px;
        }

        .qr-btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .qr-btn.close {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .qr-btn.share {
            background: var(--button-gradient);
            color: black;
        }

        .qr-btn:hover {
            transform: translateY(-2px);
        }

        /* –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .temp-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            z-index: 1001;
            backdrop-filter: blur(10px);
            text-align: center;
            max-width: 80%;
            border: 1px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.2);
            animation: messageIn 0.3s;
        }

        @keyframes messageIn {
            from { opacity: 0; transform: translate(-50%, -40%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .share-container {
                padding: 30px 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .social-share {
                flex-direction: column;
            }
            
            .social-btn {
                width: 100%;
                padding: 16px;
            }
            
            .btn-telegram,
            .btn-whatsapp {
                flex: 1;
                min-width: 100%;
            }
            
            .logo {
                font-size: 36px;
            }
            
            .avatar-container {
                width: 120px;
                height: 120px;
            }
        }
        
        @media (min-width: 481px) and (max-width: 768px) {
            .social-share {
                gap: 10px;
            }
            
            .social-btn {
                font-size: 14px;
                padding: 14px 10px;
            }
            
            .social-btn .material-icons {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- –ó–≤–µ–∑–¥—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="share-container">
        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
        <button class="close-btn" id="close-btn">
            <span class="material-icons">close</span>
        </button>

        <!-- –õ–æ–≥–æ—Ç–∏–ø -->
        <div class="logo">MEETUP</div>

        <!-- –ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="avatar-container">
            <div class="avatar-frame">
                <div id="avatar-image-container">
                    <!-- –ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="user-info">
            <div class="username" id="username">@USERNAME</div>
            <div class="user-link" id="user-link">meetup.com/@username</div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="action-buttons">
            <button class="btn-copy" id="btn-copy-link">
                <span class="material-icons">content_copy</span>
                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
            </button>
            <button class="btn-qr" id="btn-show-qr">
                <span class="material-icons">qr_code_2</span>
                QR-–∫–æ–¥
            </button>
        </div>

        <!-- –ü—Ä–∏–∑—ã–≤ -->
        <div class="call-to-action">–°–∫–æ—Ä–µ–µ –∑–æ–≤–∏ –¥—Ä—É–∑–µ–π!</div>

        <!-- –ö–Ω–æ–ø–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π -->
        <div class="social-share">
            <button class="social-btn btn-share-simple" id="btn-share-simple">
                <span class="material-icons">share</span>
                –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ
            </button>
            <button class="social-btn btn-telegram" id="btn-share-telegram">
                <span class="material-icons">telegram</span>
                –¢–µ–ª–µ–≥—Ä–∞–º
            </button>
            <button class="social-btn btn-whatsapp" id="btn-share-whatsapp">
                <span class="material-icons">chat</span>
                WhatsApp
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ QR –∫–æ–¥–∞ -->
    <div class="qr-modal" id="qr-modal">
        <div class="qr-content">
            <div class="qr-title">–ú–æ–π QR-–∫–æ–¥</div>
            <div id="qr-code">
                <div style="color: white; padding: 40px;">
                    –ó–∞–≥—Ä—É–∑–∫–∞ QR-–∫–æ–¥–∞...
                </div>
            </div>
            <div style="color: #AAAAAA; margin-top: 15px; font-size: 14px;">
                –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è
            </div>
            <div class="qr-actions">
                <button class="qr-btn close" id="close-qr">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="qr-btn share" id="share-qr-btn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É QRCode -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –°–æ–∑–¥–∞–µ–º 12 —Å–ª—É—á–∞–π–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –∑–≤–µ–∑–¥
            function createStars() {
                const starsContainer = document.body;
                const starCount = 12;
                const starCharacters = ['‚≠ê', 'üåü', '‚ú®', 'üí´', '‚òÄÔ∏è'];
                
                for (let i = 0; i < starCount; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    
                    // –°–ª—É—á–∞–π–Ω—ã–π —Å–∏–º–≤–æ–ª –∑–≤–µ–∑–¥—ã
                    const randomChar = starCharacters[Math.floor(Math.random() * starCharacters.length)];
                    star.innerHTML = randomChar;
                    
                    // –°–ª—É—á–∞–π–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–∏–∑–±–µ–≥–∞–µ–º –∫—Ä–∞–µ–≤ —ç–∫—Ä–∞–Ω–∞)
                    const margin = 5;
                    const left = margin + Math.random() * (100 - 2 * margin);
                    const top = margin + Math.random() * (100 - 2 * margin);
                    
                    // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä (20-45px)
                    const size = 20 + Math.random() * 25;
                    
                    // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
                    const delay = Math.random() * 5;
                    
                    // –°–ª—É—á–∞–π–Ω–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
                    const duration = 3 + Math.random() * 4;
                    
                    // –°–ª—É—á–∞–π–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
                    const opacity = 0.5 + Math.random() * 0.5;
                    
                    // –°–ª—É—á–∞–π–Ω—ã–π —Ç–∏–ø –∞–Ω–∏–º–∞—Ü–∏–∏
                    const animationType = Math.random() > 0.5 ? 'star-float' : 'star-float';
                    
                    star.style.left = `${left}%`;
                    star.style.top = `${top}%`;
                    star.style.fontSize = `${size}px`;
                    star.style.animationDelay = `${delay}s`;
                    star.style.animationDuration = `${duration}s`;
                    star.style.opacity = opacity;
                    star.style.animationName = animationType;
                    
                    // –°–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è
                    if (Math.random() > 0.5) {
                        star.style.animationDirection = 'alternate-reverse';
                    }
                    
                    starsContainer.appendChild(star);
                }
            }
            
            // –°–æ–∑–¥–∞–µ–º –∑–≤–µ–∑–¥—ã
            createStars();
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const currentUser = UserSystem.getCurrentUser();
            
            if (!currentUser) {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≤—Ö–æ–¥
                window.location.href = 'index.html';
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
            const closeBtn = document.getElementById('close-btn');
            const copyBtn = document.getElementById('btn-copy-link');
            const qrBtn = document.getElementById('btn-show-qr');
            const shareSimpleBtn = document.getElementById('btn-share-simple');
            const shareTelegramBtn = document.getElementById('btn-share-telegram');
            const shareWhatsappBtn = document.getElementById('btn-share-whatsapp');
            const qrModal = document.getElementById('qr-modal');
            const closeQrBtn = document.getElementById('close-qr');
            const shareQrBtn = document.getElementById('share-qr-btn');
            const avatarContainer = document.getElementById('avatar-image-container');
            const usernameEl = document.getElementById('username');
            const userLinkEl = document.getElementById('user-link');

            // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userLink = UserSystem.getPrettyFriendLink(currentUser.id) || 
                            `${window.location.origin}/@${encodeURIComponent(currentUser.nickname)}`;

            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            usernameEl.textContent = `@${currentUser.nickname.toUpperCase()}`;
            userLinkEl.textContent = userLink.replace('https://', '').replace('http://', '');

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä
            if (currentUser.avatar && currentUser.avatar.length > 0) {
                avatarContainer.innerHTML = `<img src="${currentUser.avatar}" alt="${currentUser.nickname}" class="avatar-image">`;
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É –Ω–∏–∫–Ω–µ–π–º–∞
                const firstLetter = currentUser.nickname.charAt(0).toUpperCase();
                avatarContainer.innerHTML = `<div class="avatar-placeholder">${firstLetter}</div>`;
            }

            // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            function showTempMessage(message, duration = 3000) {
                // –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                const existingMessage = document.querySelector('.temp-message');
                if (existingMessage) {
                    existingMessage.remove();
                }

                const messageEl = document.createElement('div');
                messageEl.className = 'temp-message';
                messageEl.textContent = message;
                
                document.body.appendChild(messageEl);
                
                setTimeout(() => {
                    if (messageEl.parentNode) {
                        messageEl.remove();
                    }
                }, duration);
            }

            // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏
            copyBtn.onclick = async function() {
                try {
                    await navigator.clipboard.writeText(userLink);
                    copyBtn.innerHTML = '<span class="material-icons">check</span>–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                    copyBtn.style.background = '#00AA00';
                    
                    showTempMessage('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                    
                    setTimeout(() => {
                        copyBtn.innerHTML = '<span class="material-icons">content_copy</span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É';
                        copyBtn.style.background = '';
                    }, 2000);
                } catch (err) {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    const tempInput = document.createElement('input');
                    tempInput.value = userLink;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempInput);
                    
                    showTempMessage('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
                }
            };

            // –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥
            qrBtn.onclick = function() {
                const qrContainer = document.getElementById('qr-code');
                qrContainer.innerHTML = '';
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR –∫–æ–¥
                if (typeof QRCode !== 'undefined') {
                    try {
                        new QRCode(qrContainer, {
                            text: userLink,
                            width: 200,
                            height: 200,
                            colorDark: "#000000",
                            colorLight: "#FFFFFF",
                            correctLevel: QRCode.CorrectLevel.H
                        });
                    } catch (error) {
                        qrContainer.innerHTML = `
                            <div style="color: white; padding: 40px; text-align: center;">
                                <div style="color: #FF9800; margin-bottom: 10px;">
                                    <span class="material-icons">error</span>
                                </div>
                                <div>–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è QR-–∫–æ–¥–∞</div>
                                <div style="font-size: 12px; margin-top: 10px;">${userLink}</div>
                            </div>
                        `;
                    }
                } else {
                    qrContainer.innerHTML = `
                        <div style="color: white; padding: 40px; text-align: center;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${currentUser.nickname}</div>
                            <div style="font-size: 12px; word-break: break-all;">${userLink}</div>
                        </div>
                    `;
                }
                
                qrModal.style.display = 'flex';
            };

            // –ó–∞–∫—Ä—ã—Ç—å QR –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeQrBtn.onclick = function() {
                qrModal.style.display = 'none';
            };

            // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è QR –∫–æ–¥–æ–º
            shareQrBtn.onclick = async function() {
                const qrCanvas = document.querySelector('#qr-code canvas');
                if (qrCanvas) {
                    qrCanvas.toBlob(async function(blob) {
                        const file = new File([blob], 'meetup-friend-qr.png', { type: 'image/png' });
                        
                        if (navigator.share && navigator.canShare({ files: [file] })) {
                            try {
                                await navigator.share({
                                    files: [file],
                                    title: '–î–æ–±–∞–≤—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è –≤ MeetUP!',
                                    text: '–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π —ç—Ç–æ—Ç QR-–∫–æ–¥, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è'
                                });
                            } catch (error) {
                                // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è, —Å–∫–∞—á–∏–≤–∞–µ–º
                                const link = document.createElement('a');
                                link.download = 'meetup-friend-qr.png';
                                link.href = qrCanvas.toDataURL();
                                link.click();
                                showTempMessage('QR-–∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
                            }
                        } else {
                            // Fallback: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
                            const link = document.createElement('a');
                            link.download = 'meetup-friend-qr.png';
                            link.href = qrCanvas.toDataURL();
                            link.click();
                            showTempMessage('QR-–∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
                        }
                    });
                }
            };

            // –ó–∞–∫—Ä—ã—Ç–∏–µ QR –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
            qrModal.onclick = function(e) {
                if (e.target === qrModal) {
                    qrModal.style.display = 'none';
                }
            };

            // –ü—Ä–æ—Å—Ç–æ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π
            shareSimpleBtn.onclick = async function() {
                try {
                    if (navigator.share) {
                        await navigator.share({
                            title: '–î–æ–±–∞–≤—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è –≤ MeetUP!',
                            text: `–ü—Ä–∏–≤–µ—Ç! –î–æ–±–∞–≤—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ MeetUP: ${userLink}`,
                            url: userLink
                        });
                    } else {
                        await navigator.clipboard.writeText(userLink);
                        showTempMessage('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                    }
                } catch (error) {
                    // –ö–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                    await navigator.clipboard.writeText(userLink);
                    showTempMessage('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                }
            };

            // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram
            shareTelegramBtn.onclick = function() {
                const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(userLink)}&text=${encodeURIComponent(`–ü—Ä–∏–≤–µ—Ç! –î–æ–±–∞–≤—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è –≤ MeetUP: ${currentUser.nickname}`)}`;
                window.open(telegramUrl, '_blank');
            };

            // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ WhatsApp
            shareWhatsappBtn.onclick = function() {
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(`–ü—Ä–∏–≤–µ—Ç! –î–æ–±–∞–≤—å –º–µ–Ω—è –≤ –¥—Ä—É–∑—å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ MeetUP: ${userLink}`)}`;
                window.open(whatsappUrl, '_blank');
            };

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç –≤ –ø—Ä–æ—Ñ–∏–ª—å
            closeBtn.onclick = function() {
                window.location.href = 'profile.html';
            };

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (qrModal.style.display === 'flex') {
                        qrModal.style.display = 'none';
                    } else {
                        window.location.href = 'profile.html';
                    }
                }
            });
        });
    </script>
</body>
</html>
